<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>NEXTATION â€“ Meetings & Coordination (Frases Essenciais para o Trabalho)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    :root {
      /* NEXTATION WEBSITE â€” COLOUR SYSTEM (from your PDF) */
      --bg-main: #02030b; /* Page background */
      --bg-gradient: radial-gradient(circle at top, #1c1f3b 0%, #050716 45%, #02030b 100%);
      /* Surfaces / Cards */
      --card-bg: rgba(15, 18, 40, 0.92);        /* Lesson panels */
      --card-soft-bg: rgba(18, 21, 50, 0.88);   /* Tab cards and navigation buttons */
      /* Neon accents */
      --accent-cyan: #4ef2ff;   /* Cyan highlight around edges */
      --accent-pink: #ff2f92;   /* Magenta highlight for buttons */
      --accent-green: #4dff9b;  /* Success / tab completed mark */
      --accent-yello: #ffe25f;  /* Accent blended in text gradients */
      --accent-purple: #aa5dff; /* Hover glows and edges */
      /* Text and borders */
      --muted: rgba(255,255,255,0.65);
      --border-glow: rgba(120,120,255,0.45);
      /* Shadows */
      --shadow-strong: 0 0 36px rgba(130,80,255,0.6);
      --shadow-soft: 0 0 20px rgba(0,0,0,0.65);
      /* Radii and transitions */
      --radius-lg: 22px;
      --radius-md: 16px;
      --radius-sm: 10px;
      --transition-fast: 0.18s ease-out;
      --transition-med: 0.28s ease-out;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg-gradient);
      color: #fff;
      min-height: 100vh;
      padding: 32px 24px; /* Increased padding for more overall space */
      display: flex;
      justify-content: center;
      line-height: 1.8; /* Increased line height for better readability */
    }
    .app { max-width: 1100px; width: 100%; }

    /* HEADER */
    .neon-header {
      position: relative;
      padding: 22px 24px 18px;
      border-radius: var(--radius-lg);
      background: rgba(3, 5, 20, 0.9);
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border-glow);
      margin-bottom: 32px; /* Increased margin-bottom */
      overflow: hidden;
    }
    .neon-header::before {
      content: "";
      position: absolute;
      inset: -1px;
      background: linear-gradient(90deg, #00f5ff, #ff2f92, #ffe25f, #4dff9b);
      opacity: 0.5;
      mix-blend-mode: screen;
      pointer-events: none;
      z-index: -1;
    }
    .header-main { display: flex; align-items: center; gap: 20px; margin-bottom: 12px; } /* Increased gap and margin */
    .teacher-orb {
      width: 68px; height: 68px; border-radius: 50%;
      background: radial-gradient(circle, #ffffff 0%, #00fff0 35%, #ff2f92 70%, #02030b 100%);
      box-shadow: 0 0 24px rgba(0, 255, 255, 0.7), 0 0 32px rgba(255, 0, 160, 0.55);
      flex-shrink: 0;
    }
    .brand-title {
      font-size: 1.45rem;
      background: linear-gradient(90deg, var(--accent-cyan), var(--accent-pink));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 700;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      margin-bottom: 6px;
      line-height: 1.2;
    }
    .lesson-title {
      font-size: 0.95rem;
      color: var(--muted);
      letter-spacing: 0.03em;
    }
    .header-description {
      font-size: 0.9rem;
      color: var(--muted);
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }

    /* TABS NAVIGATION */
    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 28px; /* Increased margin */
    }
    .tab-button {
      background: var(--card-soft-bg);
      color: var(--muted);
      padding: 10px 18px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(255,255,255,0.1);
      cursor: pointer;
      transition: var(--transition-fast);
      font-weight: 600;
      font-size: 0.9rem;
      letter-spacing: 0.02em;
      box-shadow: var(--shadow-soft);
    }
    .tab-button:hover {
      border-color: var(--accent-purple);
      color: #fff;
      box-shadow: 0 0 15px var(--accent-purple);
      transform: translateY(-2px);
    }
    .tab-button.active {
      background: linear-gradient(45deg, var(--accent-pink), var(--accent-purple));
      color: #fff;
      border-color: var(--accent-cyan);
      box-shadow: 0 0 20px var(--accent-cyan), inset 0 0 8px rgba(255,255,255,0.3);
      transform: translateY(-1px);
    }

    /* LESSON PANELS */
    .panels {
      display: flex;
      flex-direction: column;
      gap: 24px; /* Increased gap between panels */
    }
    .panel {
      display: none; /* Hidden by default */
      background: var(--card-bg);
      padding: 28px; /* Increased padding */
      border-radius: var(--radius-lg);
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: var(--shadow-strong);
      position: relative;
      overflow: hidden;
    }
    .panel.active { display: block; }
    .panel::before {
      content: "";
      position: absolute;
      inset: -1px;
      background: linear-gradient(45deg, var(--accent-cyan), var(--accent-pink), var(--accent-yello));
      opacity: 0.3;
      mix-blend-mode: screen;
      pointer-events: none;
      z-index: -1;
      filter: blur(15px);
    }

    .section-title {
      font-size: 1.6rem; /* Slightly larger */
      font-weight: 700;
      margin-bottom: 18px; /* Increased margin */
      background: linear-gradient(90deg, var(--accent-cyan), var(--accent-yello));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      letter-spacing: 0.04em;
      line-height: 1.3;
    }
    .section-sub {
      font-size: 1.1rem; /* Slightly larger */
      color: var(--accent-green);
      margin-bottom: 22px; /* Increased margin */
      font-weight: 500;
      letter-spacing: 0.02em;
    }
    .sub-title {
      font-size: 1.25rem; /* Larger for distinction */
      font-weight: 600;
      color: var(--accent-purple);
      margin-top: 28px; /* More space above */
      margin-bottom: 16px; /* More space below */
      border-bottom: 1px dashed rgba(255,255,255,0.1);
      padding-bottom: 8px;
      line-height: 1.4;
    }

    .block-container {
      background: var(--card-soft-bg);
      padding: 20px; /* Increased padding */
      border-radius: var(--radius-md);
      margin-bottom: 24px; /* Increased margin */
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
    }
    .block-container p { margin-bottom: 12px; } /* More space for paragraphs */

    .example-en {
      font-size: 1.15rem; /* Larger */
      font-weight: 700;
      color: var(--accent-cyan);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
      line-height: 1.4;
    }
    .example-pt {
      font-size: 1rem;
      color: var(--muted);
      margin-bottom: 12px;
      font-style: italic;
      line-height: 1.4;
    }
    .explanation {
      font-size: 0.95rem;
      color: #fff;
      margin-top: 10px;
      padding-left: 15px;
      border-left: 3px solid var(--accent-pink);
      line-height: 1.6; /* Very good line spacing */
    }

    .pill-tag {
      display: inline-block;
      background: rgba(78, 242, 255, 0.15);
      color: var(--accent-cyan);
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.8em;
      font-weight: 600;
      margin-right: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--accent-cyan);
    }

    .micro-practice-section {
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px dashed rgba(255,255,255,0.15);
    }
    .micro-practice-section h4 {
      font-size: 1.05rem;
      color: var(--accent-yello);
      margin-bottom: 10px;
      font-weight: 600;
    }
    .micro-practice-section textarea {
      width: 100%;
      padding: 12px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-glow);
      background: rgba(0,0,0,0.4);
      color: #fff;
      font-size: 1rem;
      min-height: 70px;
      resize: vertical;
      margin-bottom: 8px;
      transition: border-color var(--transition-fast);
    }
    .micro-practice-section textarea:focus {
      outline: none;
      border-color: var(--accent-cyan);
      box-shadow: 0 0 8px var(--accent-cyan);
    }
    .char-counter {
      font-size: 0.85rem;
      color: var(--muted);
      text-align: right;
      margin-bottom: 10px;
    }
    .feedback-message {
      margin-top: 10px;
      padding: 10px;
      border-radius: var(--radius-sm);
      font-size: 0.9rem;
      font-weight: 500;
      color: #fff;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
    }
    .feedback-message.correct {
      background: rgba(77, 255, 155, 0.15);
      border-color: var(--accent-green);
      color: var(--accent-green);
    }
    .feedback-message.incorrect {
      background: rgba(255, 47, 146, 0.15);
      border-color: var(--accent-pink);
      color: var(--accent-pink);
    }

    .super-tip {
      background: rgba(170, 93, 255, 0.15);
      border-left: 4px solid var(--accent-purple);
      padding: 15px 20px;
      border-radius: var(--radius-md);
      margin-top: 25px;
      margin-bottom: 25px;
      font-size: 0.95rem;
      line-height: 1.6;
      box-shadow: 0 0 12px rgba(170, 93, 255, 0.3);
    }
    .super-tip strong { color: var(--accent-purple); }

    .exercise-section {
      margin-top: 30px;
      padding-top: 25px;
      border-top: 2px solid rgba(255,255,255,0.1);
    }
    .exercise-section h3 {
      font-size: 1.4rem;
      color: var(--accent-cyan);
      margin-bottom: 20px;
      font-weight: 700;
      letter-spacing: 0.03em;
    }
    .exercise-item {
      background: var(--card-soft-bg);
      padding: 18px;
      border-radius: var(--radius-md);
      margin-bottom: 18px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .exercise-item p {
      margin-bottom: 10px;
      font-size: 1rem;
      color: #fff;
    }
    .exercise-item input[type="text"] {
      width: 100%;
      padding: 10px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-glow);
      background: rgba(0,0,0,0.3);
      color: #fff;
      font-size: 1rem;
    }
    .exercise-item .check-button {
      background: var(--accent-green);
      color: var(--bg-main);
      padding: 8px 15px;
      border: none;
      border-radius: var(--radius-sm);
      cursor: pointer;
      margin-top: 10px;
      font-weight: 600;
      transition: background var(--transition-fast);
    }
    .exercise-item .check-button:hover {
      background: #3aff8a;
      box-shadow: 0 0 10px var(--accent-green);
    }
    .exercise-feedback {
      margin-top: 10px;
      font-size: 0.9rem;
      font-weight: 500;
    }
    .exercise-feedback.correct { color: var(--accent-green); }
    .exercise-feedback.incorrect { color: var(--accent-pink); }

    .controls-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    .record-btn {
      background: var(--card-soft-bg);
      color: var(--accent-pink);
      padding: 10px 18px;
      border-radius: var(--radius-md);
      border: 1px solid var(--accent-pink);
      cursor: pointer;
      transition: var(--transition-fast);
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 0 10px rgba(255,47,146,0.3);
    }
    .record-btn:hover {
      background: var(--accent-pink);
      color: var(--bg-main);
      box-shadow: 0 0 20px var(--accent-pink);
    }
    .record-btn.recording {
      background: var(--accent-green);
      border-color: var(--accent-green);
      color: var(--bg-main);
      box-shadow: 0 0 20px var(--accent-green);
    }
    .record-btn.recording:hover {
      background: #3aff8a;
    }
    .record-dot {
      font-size: 1.2em;
      line-height: 1;
    }
    #audio-status {
      font-size: 0.85rem;
      color: var(--muted);
      flex-grow: 1;
      text-align: right;
      padding-left: 15px;
    }

    .export-bar {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255,255,255,0.1);
      display: flex;
      justify-content: flex-end;
      gap: 15px;
    }
    .export-button {
      background: var(--accent-purple);
      color: #fff;
      padding: 10px 20px;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition-fast);
      box-shadow: 0 0 15px rgba(170,93,255,0.4);
    }
    .export-button:hover {
      background: #b97eff;
      box-shadow: 0 0 25px var(--accent-purple);
      transform: translateY(-2px);
    }

    /* General text styling */
    p { margin-bottom: 1em; }
    strong { color: var(--accent-yello); }
    em { font-style: italic; color: var(--muted); }

    /* Specific elements for this lesson */
    .tip-box {
      background: rgba(78, 242, 255, 0.1);
      border-left: 4px solid var(--accent-cyan);
      padding: 15px 20px;
      border-radius: var(--radius-md);
      margin-top: 20px;
      margin-bottom: 20px;
      font-size: 0.95rem;
      line-height: 1.6;
      box-shadow: 0 0 10px rgba(78, 242, 255, 0.2);
    }
    .tip-box strong { color: var(--accent-cyan); }

    .portuguese-thinking {
      background: rgba(255, 47, 146, 0.1);
      border-left: 4px solid var(--accent-pink);
      padding: 15px 20px;
      border-radius: var(--radius-md);
      margin-top: 20px;
      margin-bottom: 20px;
      font-size: 0.95rem;
      line-height: 1.6;
      box-shadow: 0 0 10px rgba(255, 47, 146, 0.2);
    }
    .portuguese-thinking strong { color: var(--accent-pink); }

  </style>
</head>
<body>
  <div class="app">
    <header class="neon-header">
      <div class="header-main">
        <div class="teacher-orb"></div>
        <div>
          <h1 class="brand-title">NEXTATION</h1>
          <p class="lesson-title">IMERSÃƒO EM INGLÃŠS PARA ADULTOS</p>
        </div>
      </div>
      <p class="header-description">
        Bem-vindo Ã  sua estaÃ§Ã£o de aprendizado! Hoje, vamos dominar as frases e estruturas essenciais para vocÃª brilhar em <strong>reuniÃµes e coordenaÃ§Ã£o</strong> no ambiente de trabalho. Prepare-se para se comunicar com confianÃ§a e clareza! ğŸš€
      </p>
    </header>

    <nav class="tabs">
      <button class="tab-button active" onclick="showTab('overview')">ğŸ§  VisÃ£o Geral</button>
      <button class="tab-button" onclick="showTab('can-join-call')">ğŸ“ Can you join?</button>
      <button class="tab-button" onclick="showTab('check-manager')">ğŸ¤ Check with manager</button>
      <button class="tab-button" onclick="showTab('didnt-receive')">ğŸ“§ Didn't receive</button>
      <button class="tab-button" onclick="showTab('looking-for')">ğŸ’¡ Looking for</button>
      <button class="tab-button" onclick="showTab('will-update')">ğŸ”„ Will update</button>
      <button class="tab-button" onclick="showTab('resolved-issue')">âœ… Resolved issue</button>
      <button class="tab-button" onclick="showTab('back-to-normal')">ğŸ§˜â€â™€ï¸ Back to normal</button>
      <button class="tab-button" onclick="showTab('practice-time')">âœï¸ Hora da PrÃ¡tica</button>
      <button class="tab-button" onclick="showTab('talk-it-out')">ğŸ—£ï¸ Talk it Out!</button>
    </nav>

    <div class="panels">
      <!-- TAB 1: Overview -->
      <div id="overview" class="panel active">
        <div class="card-inner">
          <h2 class="section-title">ğŸ§  VisÃ£o Geral: ReuniÃµes & CoordenaÃ§Ã£o</h2>
          <p class="section-sub">Dominando a comunicaÃ§Ã£o profissional em inglÃªs.</p>

          <div class="block-container">
            <p>No mundo corporativo, a comunicaÃ§Ã£o clara e eficiente Ã© tudo! ğŸŒ Esta liÃ§Ã£o vai te equipar com frases e estruturas que sÃ£o o pÃ£o de cada dia em <strong>reuniÃµes, e-mails e conversas de coordenaÃ§Ã£o</strong>. Vamos focar em ser direto, educado e, acima de tudo, compreendido.</p>
            <p>VocÃª aprenderÃ¡ a:</p>
            <ul>
              <li>Fazer perguntas sobre disponibilidade.</li>
              <li>Expressar necessidade de consultar algo.</li>
              <li>Reportar que algo nÃ£o foi recebido.</li>
              <li>Falar sobre buscar soluÃ§Ãµes.</li>
              <li>Prometer atualizaÃ§Ãµes.</li>
              <li>Comunicar que um problema foi resolvido.</li>
              <li>Indicar que a situaÃ§Ã£o voltou ao normal.</li>
            </ul>
            <p>Cada frase Ã© uma ferramenta que vocÃª vai adicionar ao seu cinto de utilidades do Business English. Vamos lÃ¡! âœ¨</p>
          </div>

          <div class="super-tip">
            <strong>Ã‰ Nosso!</strong> ğŸ‡§ğŸ‡· Imagine que cada frase que vamos aprender Ã© como um atalho para soar mais natural e profissional. Em vez de traduzir palavra por palavra, vamos "sentir" o inglÃªs como um nativo faria em um contexto de trabalho.
          </div>

          <h3 class="sub-title">ExercÃ­cio RÃ¡pido: Conecte a Frase ao Contexto</h3>
          <div class="exercise-section">
            <div class="exercise-item">
              <p>1. Qual frase vocÃª usaria para perguntar se alguÃ©m pode participar de uma videochamada?</p>
              <input type="text" id="ex1-q1" placeholder="Sua resposta em inglÃªs...">
              <button class="check-button" onclick="checkExercise('ex1-q1', ['Can you join the call?'], 'ex1-feedback1')">Verificar</button>
              <div id="ex1-feedback1" class="exercise-feedback"></div>
            </div>
            <div class="exercise-item">
              <p>2. Como vocÃª diria que precisa falar com seu chefe antes de tomar uma decisÃ£o?</p>
              <input type="text" id="ex1-q2" placeholder="Sua resposta em inglÃªs...">
              <button class="check-button" onclick="checkExercise('ex1-q2', ['I need to check with my manager.'], 'ex1-feedback2')">Verificar</button>
              <div id="ex1-feedback2" class="exercise-feedback"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- TAB 2: Can you join the call? -->
      <div id="can-join-call" class="panel">
        <div class="card-inner">
          <h2 class="section-title">ğŸ“ Can you join the call?</h2>
          <p class="section-sub">Perguntando sobre disponibilidade em reuniÃµes.</p>

          <div class="block-container">
            <div class="example-en">
              <button class="play-audio-btn" onclick="speak('Can you join the call?')">ğŸ”Š</button>
              <span class="highlight-text">Can</span> <span class="highlight-text">you</span> <span class="highlight-text">join the call?</span>
            </div>
            <p class="example-pt">ğŸ‡§ğŸ‡· VocÃª pode entrar na chamada?</p>
            <p class="explanation">
              ğŸ“˜ Esta Ã© uma forma super comum e educada de perguntar sobre a disponibilidade de alguÃ©m para uma reuniÃ£o ou chamada.
              A estrutura Ã© a de uma pergunta com verbo modal: <strong>Modal + Sujeito + Verbo (base form)</strong>.
              <br>
              <span class="pill-tag">Modal Verb</span> <span class="pill-tag">Question</span> <span class="pill-tag">Meetings</span>
            </p>
          </div>

          <div class="portuguese-thinking">
            <strong>Pense como um brasileiro:</strong> Em portuguÃªs, dirÃ­amos "VocÃª pode entrar na chamada?". Em inglÃªs, o "Can" vem antes do sujeito para formar a pergunta. NÃ£o se esqueÃ§a do "the" antes de "call" se for uma chamada especÃ­fica!
          </div>

          <h3 class="sub-title">CenÃ¡rio de Uso:</h3>
          <div class="block-container">
            <p>Imagine que vocÃª precisa de um colega em uma reuniÃ£o de Ãºltima hora:</p>
            <p>ğŸ‘©â€ğŸ’» "Hi John, we have an urgent sync in 5 minutes. <strong>Can you join the call?</strong>"</p>
            <p>ğŸ‡§ğŸ‡· "Oi John, temos uma reuniÃ£o urgente em 5 minutos. VocÃª pode entrar na chamada?"</p>
          </div>

          <div class="micro-practice-section">
            <h4>âœï¸ Sua Vez: Escreva a frase</h4>
            <textarea id="practice-can-join" onkeyup="countChars('practice-can-join', 'counter-can-join', 50)"></textarea>
            <div id="counter-can-join" class="char-counter">0/50 caracteres</div>
            <button class="check-button" onclick="checkMicroPractice('practice-can-join', 'Can you join the call?', 'feedback-can-join')">Verificar</button>
            <div id="feedback-can-join" class="feedback-message"></div>
          </div>
        </div>
      </div>

      <!-- TAB 3: I need to check with my manager. -->
      <div id="check-manager" class="panel">
        <div class="card-inner">
          <h2 class="section-title">ğŸ¤ I need to check with my manager.</h2>
          <p class="section-sub">Expressando a necessidade de consultar alguÃ©m.</p>

          <div class="block-container">
            <div class="example-en">
              <button class="play-audio-btn" onclick="speak('I need to check with my manager.')">ğŸ”Š</button>
              <span class="highlight-text">I</span> <span class="highlight-text">need to check with</span> <span class="highlight-text">my manager.</span>
            </div>
            <p class="example-pt">ğŸ‡§ğŸ‡· Eu preciso verificar com meu gerente.</p>
            <p class="explanation">
              ğŸ“˜ A expressÃ£o <strong>"need to check with"</strong> Ã© perfeita para quando vocÃª precisa consultar uma pessoa antes de dar uma resposta ou tomar uma decisÃ£o. Ã‰ profissional e indica que vocÃª estÃ¡ buscando a informaÃ§Ã£o correta.
              <br>
              <span class="pill-tag">Necessity</span> <span class="pill-tag">Consultation</span> <span class="pill-tag">Workplace</span>
            </p>
          </div>

          <div class="super-tip">
            <strong>Ã‰ Nosso!</strong> ğŸ‡§ğŸ‡· Em portuguÃªs, dirÃ­amos "preciso ver com meu gerente" ou "preciso falar com meu gerente". Em inglÃªs, "check with" Ã© a forma mais natural e comum para essa aÃ§Ã£o de consulta.
          </div>

          <h3 class="sub-title">CenÃ¡rio de Uso:</h3>
          <div class="block-container">
            <p>Seu cliente pergunta sobre um desconto que vocÃª nÃ£o tem autonomia para aprovar:</p>
            <p>ğŸ§‘â€ğŸ’¼ "That's a good question. <strong>I need to check with my manager</strong> and I'll get back to you."</p>
            <p>ğŸ‡§ğŸ‡· "Essa Ã© uma boa pergunta. Preciso verificar com meu gerente e te retorno."</p>
          </div>

          <div class="micro-practice-section">
            <h4>âœï¸ Sua Vez: Escreva a frase</h4>
            <textarea id="practice-check-manager" onkeyup="countChars('practice-check-manager', 'counter-check-manager', 60)"></textarea>
            <div id="counter-check-manager" class="char-counter">0/60 caracteres</div>
            <button class="check-button" onclick="checkMicroPractice('practice-check-manager', 'I need to check with my manager.', 'feedback-check-manager')">Verificar</button>
            <div id="feedback-check-manager" class="feedback-message"></div>
          </div>
        </div>
      </div>

      <!-- TAB 4: She didnâ€™t receive the email. -->
      <div id="didnt-receive" class="panel">
        <div class="card-inner">
          <h2 class="section-title">ğŸ“§ She didnâ€™t receive the email.</h2>
          <p class="section-sub">Reportando que algo nÃ£o foi recebido no passado.</p>

          <div class="block-container">
            <div class="example-en">
              <button class="play-audio-btn" onclick="speak('She didnâ€™t receive the email.')">ğŸ”Š</button>
              <span class="highlight-text">She</span> <span class="highlight-text">didnâ€™t receive</span> <span class="highlight-text">the email.</span>
            </div>
            <p class="example-pt">ğŸ‡§ğŸ‡· Ela nÃ£o recebeu o e-mail.</p>
            <p class="explanation">
              ğŸ“˜ Para formar o <strong>passado negativo</strong> em inglÃªs com verbos de aÃ§Ã£o, usamos <strong>"didn't"</strong> (did + not) seguido do <strong>verbo na forma base (infinitivo sem "to")</strong>.
              <br>
              <span class="pill-tag">Past Simple</span> <span class="pill-tag">Negative</span> <span class="pill-tag">Communication</span>
            </p>
          </div>

          <div class="portuguese-thinking">
            <strong>Pense como um brasileiro:</strong> Em portuguÃªs, basta adicionar "nÃ£o" antes do verbo ("nÃ£o recebeu"). Em inglÃªs, precisamos do auxiliar "did" no negativo ("didn't") e o verbo principal (receive) volta para sua forma original.
          </div>

          <h3 class="sub-title">CenÃ¡rio de Uso:</h3>
          <div class="block-container">
            <p>VocÃª estÃ¡ perguntando sobre um e-mail importante que deveria ter chegado:</p>
            <p>ğŸ‘¥ "Did Sarah get the project brief?" <br> ğŸ§‘â€ğŸ’» "No, <strong>she didnâ€™t receive the email</strong>. I'll resend it."</p>
            <p>ğŸ‡§ğŸ‡· "A Sarah recebeu o resumo do projeto?" <br> "NÃ£o, ela nÃ£o recebeu o e-mail. Vou reenviar."</p>
          </div>

          <div class="micro-practice-section">
            <h4>âœï¸ Sua Vez: Escreva a frase</h4>
            <textarea id="practice-didnt-receive" onkeyup="countChars('practice-didnt-receive', 'counter-didnt-receive', 60)"></textarea>
            <div id="counter-didnt-receive" class="char-counter">0/60 caracteres</div>
            <button class="check-button" onclick="checkMicroPractice('practice-didnt-receive', 'She didnâ€™t receive the email.', 'feedback-didnt-receive')">Verificar</button>
            <div id="feedback-didnt-receive" class="feedback-message"></div>
          </div>
        </div>
      </div>

      <!-- TAB 5: We are looking for a workaround. -->
      <div id="looking-for" class="panel">
        <div class="card-inner">
          <h2 class="section-title">ğŸ’¡ We are looking for a workaround.</h2>
          <p class="section-sub">Expressando a busca por uma soluÃ§Ã£o alternativa.</p>

          <div class="block-container">
            <div class="example-en">
              <button class="play-audio-btn" onclick="speak('We are looking for a workaround.')">ğŸ”Š</button>
              <span class="highlight-text">We</span> <span class="highlight-text">are looking for</span> <span class="highlight-text">a workaround.</span>
            </div>
            <p class="example-pt">ğŸ‡§ğŸ‡· Estamos buscando uma soluÃ§Ã£o alternativa.</p>
            <p class="explanation">
              ğŸ“˜ Aqui temos o phrasal verb <strong>"look for"</strong>, que significa "procurar" ou "buscar". Ele estÃ¡ no Present Continuous ("are looking") para indicar uma aÃ§Ã£o em andamento. <strong>"Workaround"</strong> Ã© um termo de negÃ³cios para uma soluÃ§Ã£o temporÃ¡ria ou alternativa.
              <br>
              <span class="pill-tag">Phrasal Verb</span> <span class="pill-tag">Present Continuous</span> <span class="pill-tag">Problem Solving</span>
            </p>
          </div>

          <div class="super-tip">
            <strong>Ã‰ Nosso!</strong> ğŸ‡§ğŸ‡· "Look for" Ã© um phrasal verb inseparÃ¡vel. Ou seja, a preposiÃ§Ã£o "for" sempre fica junto do "look". Ã‰ como "procurar por" em portuguÃªs, mas sem o "por" no final da frase.
          </div>

          <h3 class="sub-title">CenÃ¡rio de Uso:</h3>
          <div class="block-container">
            <p>Um problema surgiu e sua equipe estÃ¡ trabalhando para resolvÃª-lo:</p>
            <p>ğŸ‘¨â€ğŸ’» "The system is down, but don't worry. <strong>We are looking for a workaround</strong> to get things running again."</p>
            <p>ğŸ‡§ğŸ‡· "O sistema estÃ¡ fora do ar, mas nÃ£o se preocupe. Estamos buscando uma soluÃ§Ã£o alternativa para fazer as coisas funcionarem novamente."</p>
          </div>

          <div class="micro-practice-section">
            <h4>âœï¸ Sua Vez: Escreva a frase</h4>
            <textarea id="practice-looking-for" onkeyup="countChars('practice-looking-for', 'counter-looking-for', 70)"></textarea>
            <div id="counter-looking-for" class="char-counter">0/70 caracteres</div>
            <button class="check-button" onclick="checkMicroPractice('practice-looking-for', 'We are looking for a workaround.', 'feedback-looking-for')">Verificar</button>
            <div id="feedback-looking-for" class="feedback-message"></div>
          </div>
        </div>
      </div>

      <!-- TAB 6: I will update you soon. -->
      <div id="will-update" class="panel">
        <div class="card-inner">
          <h2 class="section-title">ğŸ”„ I will update you soon.</h2>
          <p class="section-sub">Prometendo uma atualizaÃ§Ã£o em breve.</p>

          <div class="block-container">
            <div class="example-en">
              <button class="play-audio-btn" onclick="speak('I will update you soon.')">ğŸ”Š</button>
              <span class="highlight-text">I</span> <span class="highlight-text">will update</span> <span class="highlight-text">you soon.</span>
            </div>
            <p class="example-pt">ğŸ‡§ğŸ‡· Vou te atualizar em breve.</p>
            <p class="explanation">
              ğŸ“˜ Usamos <strong>"will"</strong> para expressar aÃ§Ãµes futuras, especialmente promessas ou decisÃµes tomadas no momento da fala. O verbo <strong>"update"</strong> (atualizar) Ã© seguido diretamente pelo objeto (you), sem preposiÃ§Ã£o.
              <br>
              <span class="pill-tag">Future Simple</span> <span class="pill-tag">Promise</span> <span class="pill-tag">Follow-up</span>
            </p>
          </div>

          <div class="portuguese-thinking">
            <strong>Pense como um brasileiro:</strong> Em portuguÃªs, dizemos "Vou *te* atualizar". Em inglÃªs, o "you" (vocÃª/te) vem logo depois do verbo "update" como objeto direto. Ã‰ uma construÃ§Ã£o muito comum!
          </div>

          <h3 class="sub-title">CenÃ¡rio de Uso:</h3>
          <div class="block-container">
            <p>ApÃ³s uma reuniÃ£o, vocÃª precisa consolidar algumas informaÃ§Ãµes antes de passar adiante:</p>
            <p>ğŸ—£ï¸ "I'll gather all the details and <strong>I will update you soon</strong> on the next steps."</p>
            <p>ğŸ‡§ğŸ‡· "Vou reunir todos os detalhes e te atualizarei em breve sobre os prÃ³ximos passos."</p>
          </div>

          <div class="micro-practice-section">
            <h4>âœï¸ Sua Vez: Escreva a frase</h4>
            <textarea id="practice-will-update" onkeyup="countChars('practice-will-update', 'counter-will-update', 50)"></textarea>
            <div id="counter-will-update" class="char-counter">0/50 caracteres</div>
            <button class="check-button" onclick="checkMicroPractice('practice-will-update', 'I will update you soon.', 'feedback-will-update')">Verificar</button>
            <div id="feedback-will-update" class="feedback-message"></div>
          </div>
        </div>
      </div>

      <!-- TAB 7: They have resolved the issue. -->
      <div id="resolved-issue" class="panel">
        <div class="card-inner">
          <h2 class="section-title">âœ… They have resolved the issue.</h2>
          <p class="section-sub">Comunicando a resoluÃ§Ã£o de um problema.</p>

          <div class="block-container">
            <div class="example-en">
              <button class="play-audio-btn" onclick="speak('They have resolved the issue.')">ğŸ”Š</button>
              <span class="highlight-text">They</span> <span class="highlight-text">have resolved</span> <span class="highlight-text">the issue.</span>
            </div>
            <p class="example-pt">ğŸ‡§ğŸ‡· Eles resolveram o problema.</p>
            <p class="explanation">
              ğŸ“˜ Esta frase usa o <strong>Present Perfect</strong> (have/has + past participle). Ele Ã© usado para aÃ§Ãµes que aconteceram no passado, mas que tÃªm um <strong>impacto ou relevÃ¢ncia no presente</strong>. O problema foi resolvido, e o resultado (a soluÃ§Ã£o) Ã© importante agora.
              <br>
              <span class="pill-tag">Present Perfect</span> <span class="pill-tag">Completion</span> <span class="pill-tag">Problem Solving</span>
            </p>
          </div>

          <div class="super-tip">
            <strong>Impacto Agora!</strong> ğŸ‡§ğŸ‡· Pense no Present Perfect como algo que aconteceu no passado, mas cujas consequÃªncias vocÃª ainda sente ou vÃª. "Eles resolveram" (passado simples) mas o foco Ã© que *agora estÃ¡ resolvido*.
          </div>

          <h3 class="sub-title">CenÃ¡rio de Uso:</h3>
          <div class="block-container">
            <p>VocÃª estÃ¡ dando um status sobre um problema tÃ©cnico que foi corrigido:</p>
            <p>ğŸ› ï¸ "Good news! Our team worked quickly, and <strong>they have resolved the issue</strong>. The system is fully operational."</p>
            <p>ğŸ‡§ğŸ‡· "Boas notÃ­cias! Nossa equipe trabalhou rÃ¡pido, e eles resolveram o problema. O sistema estÃ¡ totalmente operacional."</p>
          </div>

          <div class="micro-practice-section">
            <h4>âœï¸ Sua Vez: Escreva a frase</h4>
            <textarea id="practice-resolved-issue" onkeyup="countChars('practice-resolved-issue', 'counter-resolved-issue', 60)"></textarea>
            <div id="counter-resolved-issue" class="char-counter">0/60 caracteres</div>
            <button class="check-button" onclick="checkMicroPractice('practice-resolved-issue', 'They have resolved the issue.', 'feedback-resolved-issue')">Verificar</button>
            <div id="feedback-resolved-issue" class="feedback-message"></div>
          </div>
        </div>
      </div>

      <!-- TAB 8: Everything is back to normal. -->
      <div id="back-to-normal" class="panel">
        <div class="card-inner">
          <h2 class="section-title">ğŸ§˜â€â™€ï¸ Everything is back to normal.</h2>
          <p class="section-sub">Comunicando o retorno Ã  normalidade apÃ³s um evento.</p>

          <div class="block-container">
            <div class="example-en">
              <button class="play-audio-btn" onclick="speak('Everything is back to normal.')">ğŸ”Š</button>
              <span class="highlight-text">Everything</span> <span class="highlight-text">is back</span> <span class="highlight-text">to normal.</span>
            </div>
            <p class="example-pt">ğŸ‡§ğŸ‡· Tudo voltou ao normal.</p>
            <p class="explanation">
              ğŸ“˜ Esta Ã© uma expressÃ£o fixa muito Ãºtil para indicar que uma situaÃ§Ã£o, apÃ³s um problema ou interrupÃ§Ã£o, retornou ao seu estado habitual. A chave aqui Ã© que <strong>"Everything" (tudo) funciona como sujeito singular</strong> em inglÃªs, por isso usamos "is".
              <br>
              <span class="pill-tag">Fixed Expression</span> <span class="pill-tag">Singular Subject</span> <span class="pill-tag">Status Update</span>
            </p>
          </div>

          <div class="portuguese-thinking">
            <strong>Pense como um brasileiro:</strong> Em portuguÃªs, "tudo" pode parecer plural, mas em inglÃªs, "everything" Ã© sempre singular. Por isso, nunca diga "Everything are back to normal"!
          </div>

          <h3 class="sub-title">CenÃ¡rio de Uso:</h3>
          <div class="block-container">
            <p>ApÃ³s a resoluÃ§Ã£o de um incidente, vocÃª informa a equipe:</p>
            <p>ğŸ“¢ "The system reboot was successful. <strong>Everything is back to normal</strong> now. Thank you for your patience!"</p>
            <p>ğŸ‡§ğŸ‡· "A reinicializaÃ§Ã£o do sistema foi bem-sucedida. Tudo voltou ao normal agora. Obrigado pela paciÃªncia!"</p>
          </div>

          <div class="micro-practice-section">
            <h4>âœï¸ Sua Vez: Escreva a frase</h4>
            <textarea id="practice-back-to-normal" onkeyup="countChars('practice-back-to-normal', 'counter-back-to-normal', 60)"></textarea>
            <div id="counter-back-to-normal" class="char-counter">0/60 caracteres</div>
            <button class="check-button" onclick="checkMicroPractice('practice-back-to-normal', 'Everything is back to normal.', 'feedback-back-to-normal')">Verificar</button>
            <div id="feedback-back-to-normal" class="feedback-message"></div>
          </div>
        </div>
      </div>

      <!-- TAB 9: Practice Time! -->
      <div id="practice-time" class="panel">
        <div class="card-inner">
          <h2 class="section-title">âœï¸ Hora da PrÃ¡tica!</h2>
          <p class="section-sub">Coloque em prÃ¡tica o que vocÃª aprendeu com mais exercÃ­cios.</p>

          <div class="block-container">
            <p>Agora Ã© a sua chance de consolidar o conhecimento! Tente completar as frases ou traduzir, usando as estruturas que acabamos de ver. Lembre-se das dicas e da forma de pensar em inglÃªs. ğŸ’ª</p>
          </div>

          <div class="exercise-section">
            <div class="exercise-item">
              <p>1. (Traduza) "VocÃª pode me enviar o relatÃ³rio atÃ© o final do dia?"</p>
              <input type="text" id="ex-pt1" placeholder="Sua resposta em inglÃªs...">
              <button class="check-button" onclick="checkExercise('ex-pt1', ['Can you send me the report by the end of the day?', 'Can you send the report to me by the end of the day?'], 'ex-feedback1')">Verificar</button>
              <div id="ex-feedback1" class="exercise-feedback"></div>
            </div>
            <div class="exercise-item">
              <p>2. (Complete) "I need to _________ the client before confirming." (verificar com)</p>
              <input type="text" id="ex-complete2" placeholder="Sua resposta...">
              <button class="check-button" onclick="checkExercise('ex-complete2', ['check with'], 'ex-feedback2')">Verificar</button>
              <div id="ex-feedback2" class="exercise-feedback"></div>
            </div>
            <div class="exercise-item">
              <p>3. (Traduza) "Ele nÃ£o recebeu o convite para a reuniÃ£o."</p>
              <input type="text" id="ex-pt3" placeholder="Sua resposta em inglÃªs...">
              <button class="check-button" onclick="checkExercise('ex-pt3', ['He didnâ€™t receive the meeting invitation.', 'He did not receive the meeting invitation.'], 'ex-feedback3')">Verificar</button>
              <div id="ex-feedback3" class="exercise-feedback"></div>
            </div>
            <div class="exercise-item">
              <p>4. (Complete) "We are still _________ a solution for the bug." (procurando por)</p>
              <input type="text" id="ex-complete4" placeholder="Sua resposta...">
              <button class="check-button" onclick="checkExercise('ex-complete4', ['looking for'], 'ex-feedback4')">Verificar</button>
              <div id="ex-feedback4" class="exercise-feedback"></div>
            </div>
            <div class="exercise-item">
              <p>5. (Traduza) "Vou te avisar assim que tivermos novidades."</p>
              <input type="text" id="ex-pt5" placeholder="Sua resposta em inglÃªs...">
              <button class="check-button" onclick="checkExercise('ex-pt5', ['I will let you know as soon as we have news.', 'I will update you as soon as we have news.'], 'ex-feedback5')">Verificar</button>
              <div id="ex-feedback5" class="exercise-feedback"></div>
            </div>
            <div class="exercise-item">
              <p>6. (Traduza) "A equipe resolveu o problema de seguranÃ§a."</p>
              <input type="text" id="ex-pt6" placeholder="Sua resposta em inglÃªs...">
              <button class="check-button" onclick="checkExercise('ex-pt6', ['The team has resolved the security issue.', 'The team resolved the security issue.'], 'ex-feedback6')">Verificar</button>
              <div id="ex-feedback6" class="exercise-feedback"></div>
            </div>
            <div class="exercise-item">
              <p>7. (Complete) "After the maintenance, _________ is back to normal." (tudo)</p>
              <input type="text" id="ex-complete7" placeholder="Sua resposta...">
              <button class="check-button" onclick="checkExercise('ex-complete7', ['everything'], 'ex-feedback7')">Verificar</button>
              <div id="ex-feedback7" class="exercise-feedback"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- TAB 10: Talk it Out! -->
      <div id="talk-it-out" class="panel">
        <div class="card-inner">
          <h2 class="section-title">ğŸ—£ï¸ Talk it Out!</h2>
          <p class="section-sub">Pratique sua fala e ganhe fluÃªncia em Business English.</p>

          <div class="block-container">
            <p>Chegou a hora de soltar a voz! Use o botÃ£o abaixo para simular um "momento de prÃ¡tica" e fale em voz alta as frases que vocÃª aprendeu. Imagine-se em uma reuniÃ£o, dando um status ou fazendo uma pergunta.</p>
            <p>Tente criar suas prÃ³prias frases usando as estruturas: "Can you...?", "I need to check with...", "She didn't...", "We are looking for...", "I will update you...", "They have resolved...", "Everything is back to normal."</p>
            <p>A repetiÃ§Ã£o em voz alta Ã© crucial para internalizar a pronÃºncia e a entonaÃ§Ã£o corretas. NÃ£o tenha medo de errar, apenas pratique! ğŸ¤</p>
          </div>

          <div class="controls-row">
            <button id="record-btn" class="record-btn" onclick="togglePractice()">
              <span id="record-dot" class="record-dot">âºï¸</span>
              <span id="record-text">Marcar momento de prÃ¡tica</span>
            </button>
            <span id="audio-status">Nenhum Ã¡udio real Ã© gravado â€“ use o botÃ£o como compromisso de prÃ¡tica em voz alta. ğŸ§</span>
          </div>

          <div class="super-tip">
            <strong>Dica de FluÃªncia:</strong> Tente usar as frases em diferentes contextos. Por exemplo, em vez de "Can you join the call?", tente "Can you send the report?" ou "Can you help me with this?". Varie para solidificar o aprendizado!
          </div>
        </div>
      </div>

    </div>

    <footer class="export-bar">
      <button class="export-button" onclick="copyToSpreadsheet()">ğŸ“‹ Copiar para Planilha</button>
      <button class="export-button" onclick="exportPdf()">ğŸ“„ Exportar para PDF</button>
    </footer>

  </div>

  <script>
    let recording = false; // Global state for practice button

    // --- Tab Switching ---
    function showTab(tabId) {
      const panels = document.querySelectorAll('.panel');
      panels.forEach(panel => {
        panel.classList.remove('active');
      });
      document.getElementById(tabId).classList.add('active');

      const buttons = document.querySelectorAll('.tab-button');
      buttons.forEach(button => {
        button.classList.remove('active');
      });
      document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`).classList.add('active');

      // Reset practice state when switching tabs
      resetPractice();
    }

    // --- Micro Practice (Textarea) ---
    function countChars(textareaId, counterId, maxLength) {
      const textarea = document.getElementById(textareaId);
      const counter = document.getElementById(counterId);
      const currentLength = textarea.value.length;
      counter.textContent = `${currentLength}/${maxLength} caracteres`;
      if (currentLength > maxLength) {
        counter.style.color = 'var(--accent-pink)';
      } else {
        counter.style.color = 'var(--muted)';
      }
    }

    function checkMicroPractice(textareaId, correctPhrase, feedbackId) {
      const textarea = document.getElementById(textareaId);
      const feedback = document.getElementById(feedbackId);
      const userAnswer = textarea.value.trim();

      // Normalize for comparison (remove punctuation, extra spaces, make lowercase)
      const normalize = (text) => text.toLowerCase().replace(/[.,!?;:]/g, '').replace(/\s{2,}/g, ' ');
      const normalizedUserAnswer = normalize(userAnswer);
      const normalizedCorrectPhrase = normalize(correctPhrase);

      if (normalizedUserAnswer === normalizedCorrectPhrase) {
        feedback.textContent = 'ğŸ‰ Perfeito! VocÃª acertou!';
        feedback.className = 'feedback-message correct';
      } else {
        feedback.textContent = `ğŸ˜• Quase lÃ¡! A resposta esperada era: "${correctPhrase}". Tente novamente!`;
        feedback.className = 'feedback-message incorrect';
      }
    }

    // --- General Exercises (Input) ---
    function checkExercise(inputId, correctAnswers, feedbackId) {
      const input = document.getElementById(inputId);
      const feedback = document.getElementById(feedbackId);
      const userAnswer = input.value.trim();

      const normalize = (text) => text.toLowerCase().replace(/[.,!?;:]/g, '').replace(/\s{2,}/g, ' ');
      const normalizedUserAnswer = normalize(userAnswer);

      const isCorrect = correctAnswers.some(answer => normalize(answer) === normalizedUserAnswer);

      if (isCorrect) {
        feedback.textContent = 'ğŸ‰ Correto! Muito bem!';
        feedback.className = 'exercise-feedback correct';
      } else {
        feedback.textContent = `ğŸ˜• Tente novamente. A resposta esperada era uma das seguintes: "${correctAnswers.join('", "')}".`;
        feedback.className = 'exercise-feedback incorrect';
      }
    }

    // --- Audio Playback ---
    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US'; // Set language to English
      window.speechSynthesis.speak(utterance);
    }

    // --- Practice Recording Toggle ---
    function togglePractice(){
      recording = !recording;
      const btn = document.getElementById('record-btn');
      const txt = document.getElementById('record-text');
      const dot = document.getElementById('record-dot');
      const status = document.getElementById('audio-status');
      if(!btn || !txt || !dot || !status) return;

      if(recording){
        btn.classList.add('recording');
        dot.textContent = 'ğŸ”´';
        txt.textContent = 'Praticando agora...';
        status.innerHTML = 'Momento de prÃ¡tica: fale em voz alta suas frases de Business English. Use: <strong>Can you join, check with, didn\'t receive, looking for, will update, have resolved, back to normal</strong> e outros que vocÃª criar! ğŸ§';
      }else{
        btn.classList.remove('recording');
        dot.textContent = 'âºï¸';
        txt.textContent = 'Marcar momento de prÃ¡tica';
        status.textContent = 'PrÃ¡tica pausada. Clique de novo quando quiser focar na fala.';
      }
    }

    function resetPractice(){
      recording = false;
      const btn = document.getElementById('record-btn');
      const txt = document.getElementById('record-text');
      const dot = document.getElementById('record-dot');
      const status = document.getElementById('audio-status');
      if(!btn || !txt || !dot || !status) return;

      btn.classList.remove('recording');
      dot.textContent = 'âºï¸';
      txt.textContent = 'Marcar momento de prÃ¡tica';
      status.innerHTML = 'Nenhum Ã¡udio real Ã© gravado â€“ use o botÃ£o como compromisso de prÃ¡tica em voz alta. ğŸ§';
    }

    function copyToSpreadsheet(){
      const text = collectLessonText();
      if(!navigator.clipboard){
        alert('Seu navegador nÃ£o permite cÃ³pia automÃ¡tica. Selecione o texto manualmente.');
        return;
      }
      navigator.clipboard.writeText(text).then(()=>{
        alert('ConteÃºdo copiado! Cole (Ctrl+V) na sua planilha.');
      }).catch(()=>{
        alert('NÃ£o foi possÃ­vel copiar automaticamente. Selecione e copie manualmente.');
      });
    }

    function collectLessonText(){
      const blocks = [];
      document.querySelectorAll('.card-inner').forEach(inner=>{
        const clone = inner.cloneNode(true);
        // Remove interactive elements and non-content parts from the cloned content
        clone.querySelectorAll('button, input, textarea, select, label, .micro-practice-section, .super-tip, .char-counter, .feedback-message, .controls-row, .export-bar, .footer-nav, .footer-meta, .neon-header, .tabs, .app, .block-container ul, .example-en, .example-pt, .section-sub, .section-title, .sub-title, .exercise-section, .diagram-container, .syllable-counter-section, .adjective-example, .mistake-item, .tip-box, .portuguese-thinking').forEach(el=>el.remove());
        // Clean up extra spaces/newlines
        let cleanedText = clone.innerText.trim();
        cleanedText = cleanedText.replace(/\s{2,}/g, ' '); // Replace multiple spaces with single space
        cleanedText = cleanedText.replace(/\n\s*\n/g, '\n\n'); // Replace multiple newlines with double newline
        blocks.push(cleanedText);
      });
      return blocks.join('\n\n-----------------------------\n\n');
    }

    async function exportPdf() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'pt', 'a4'); // 'p' for portrait, 'pt' for points, 'a4' for A4 size

        const content = document.querySelector('.panels'); // Select the main content area

        // Temporarily show all panels to capture content for PDF
        const allPanels = document.querySelectorAll('.panel');
        allPanels.forEach(panel => panel.style.display = 'block');

        // Capture content with html2canvas
        const canvas = await html2canvas(content, {
            scale: 2, // Increase scale for better resolution
            useCORS: true, // Enable cross-origin images if any
            windowWidth: content.scrollWidth,
            windowHeight: content.scrollHeight,
            x: content.offsetLeft,
            y: content.offsetTop,
            width: content.offsetWidth,
            height: content.offsetHeight
        });

        // Restore original panel display
        allPanels.forEach(panel => panel.style.display = 'none');
        document.querySelector('.panel.active').style.display = 'block'; // Show only the active panel again

        const imgData = canvas.toDataURL('image/png');
        const imgWidth = 595; // A4 width in points
        const pageHeight = 842; // A4 height in points
        const imgHeight = canvas.height * imgWidth / canvas.width;
        let heightLeft = imgHeight;

        let position = 0;

        doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;

        while (heightLeft >= 0) {
            position = heightLeft - imgHeight;
            doc.addPage();
            doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;
        }

        doc.save('NEXTATION_Lesson_Meetings_Coordination.pdf');
    }

    // Initial tab display
    document.addEventListener('DOMContentLoaded', () => {
      showTab('overview');
    });
  </script>
</body>
</html>
